<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, user-scalable=no">
  <meta name="description" content="API docs for the generateAndWriteAssets method from the GenerativeSupport class, for the Dart programming language.">
  <title>generateAndWriteAssets method - GenerativeSupport class - jetleaf_devtool library - Dart API</title>


  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,300;0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet">
  
  <link rel="stylesheet" href="../../static-assets/github.css?v1">
  <link rel="stylesheet" href="../../static-assets/styles.css?v1">
  <link rel="icon" href="../../static-assets/favicon.png?v1">
  
</head>

<body data-base-href="../../" data-using-base-href="false" class="light-theme">
<div id="overlay-under-drawer"></div>
<header id="title">
  <span id="sidenav-left-toggle" class="material-symbols-outlined" role="button" tabindex="0">menu</span>
  <ol class="breadcrumbs gt-separated dark hidden-xs">
    <li><a href="../../index.html">jetleaf_devtool</a></li>
    <li><a href="../../jetleaf_devtool/">jetleaf_devtool.dart</a></li>
    <li><a href="../../jetleaf_devtool/GenerativeSupport-class.html">GenerativeSupport</a></li>
    <li class="self-crumb">generateAndWriteAssets method</li>
  </ol>
  <div class="self-name">generateAndWriteAssets</div>
  <form class="search navbar-right" role="search">
    <input type="text" id="search-box" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
  </form>
  <button class="toggle" id="theme-button" title="Toggle between light and dark mode" aria-label="Light and dark mode toggle">
    <span id="dark-theme-button" class="material-symbols-outlined" aria-hidden="true">
      dark_mode
    </span>
    <span id="light-theme-button" class="material-symbols-outlined" aria-hidden="true">
      light_mode
    </span>
  </button>
</header>
<main>
<div
    id="dartdoc-main-content"
    class="main-content"
    data-above-sidebar="jetleaf_devtool&#47;GenerativeSupport-class-sidebar.html"
    data-below-sidebar="">
    <div>
<h1><span class="kind-method">generateAndWriteAssets</span> method 
</h1></div>

    <section class="multi-line-signature">
      
  <div>
    <ol class="annotation-list">
        <li>@<a href="https://pub.dev/documentation/meta/1.17.0/meta/protected-constant.html">protected</a></li>
    </ol>
  </div>
<span class="returntype"><a href="https://api.dart.dev/stable/3.9.2/dart-core/Future-class.html">Future</a><span class="signature">&lt;<wbr><span class="type-parameter"><a href="https://api.dart.dev/stable/3.9.2/dart-core/String-class.html">String</a></span>&gt;</span></span>
<span class="name ">generateAndWriteAssets</span>(<wbr><ol class="parameter-list"> <li><span class="parameter" id="generateAndWriteAssets-param-targetPath"><span class="type-annotation"><a href="https://api.dart.dev/stable/3.9.2/dart-core/String-class.html">String</a></span> <span class="parameter-name">targetPath</span>, </span></li>
<li><span class="parameter" id="generateAndWriteAssets-param-packageName"><span class="type-annotation"><a href="https://api.dart.dev/stable/3.9.2/dart-core/String-class.html">String</a></span> <span class="parameter-name">packageName</span>, </span></li>
<li><span class="parameter" id="generateAndWriteAssets-param-fileUtils"><span class="type-annotation"><a href="https://pub.dev/documentation/jetleaf_build/1.0.0/jetleaf_build/FileUtility-class.html">FileUtility</a></span> <span class="parameter-name">fileUtils</span>, </span></li>
<li><span class="parameter" id="generateAndWriteAssets-param-logger"><span class="type-annotation">CliLogger</span> <span class="parameter-name">logger</span>, </span></li>
</ol>)

      

    </section>
    
<section class="desc markdown">
  <p>Discovers all non-Dart resource files in the target package and generates
strongly-typed Dart wrapper classes (<code>GenerativeAsset</code>) for each of them.</p>
<p>This method performs the full ‚Äúasset embedding‚Äù step of the JetLeaf
bootstrap process. It scans the user‚Äôs package, collects every file that
qualifies as an embeddable resource (HTML, JSON, configuration files,
templates, images, etc.), and emits a Dart file for each asset containing:</p>
<ul>
<li>
<p>Static metadata:</p>
<ul>
<li>package name</li>
<li>file path within the package</li>
<li>file name</li>
</ul>
</li>
<li>
<p>A no-argument constructor (required for runtime mirror instantiation)</p>
</li>
<li>
<p>A <code>Uint8List</code> literal containing the asset‚Äôs raw bytes</p>
</li>
</ul>
<p>The generated classes extend <code>GenerativeAsset</code> and follow this pattern:</p>
<pre class="language-dart"><code class="language-dart">final class &lt;SanitizedClassName&gt; extends GenerativeAsset {
  &lt;SanitizedClassName&gt;();

  @override
  String getFilePath() =&gt; '...';

  @override
  String getFileName() =&gt; '...';

  @override
  String? getPackageName() =&gt; '...';

  @override
  Uint8List getContentBytes() =&gt; Uint8List.fromList([0x00, 0xFF, ...]);
}
</code></pre>
<h2 id="output-location">Output Location</h2>
<p>All generated asset wrappers are written to:</p>
<pre class="language-text"><code class="language-text">&lt;buildDir&gt;/&lt;jetleaf_generated&gt;/assets/*.dart
</code></pre>
<p>The directory is created automatically if missing. Each generated file:</p>
<ul>
<li>Is named using <code>snake_case</code> based on the constructed class name</li>
<li>Contains full JetLeaf copyright &amp; license headers</li>
<li>Is marked as <strong>auto-generated</strong> (do not edit)</li>
</ul>
<h2 id="return-value">Return Value</h2>
<p>Returns a <code>String</code> containing import statements pointing to all
generated asset classes. These imports must later be inserted into the
bootstrap runtime file so that the generated resources are included in the
final <code>.dill</code>.</p>
<p>Example returned import:</p>
<pre class="language-dart"><code class="language-dart">import 'generated/assets/my_app_logo_generative_asset.dart';
</code></pre>
<h2 id="spinner-output">Spinner Output</h2>
<p>A CLI spinner is displayed during generation:</p>
<ul>
<li>Starts: ‚Äúüîç Embedding assets into Dart classes‚Ä¶‚Äù</li>
<li>Success (with assets): ‚Äú‚úÖ Embedded N resources into Dart classes ‚Ä¶‚Äù</li>
<li>Success (none found): ‚Äú‚ÑπÔ∏è No non-Dart resource files found to embed.‚Äù</li>
</ul>
<h2 id="parameters">Parameters</h2>
<ul>
<li>
<p><strong><code>targetPath</code></strong><br>
The absolute path to the final bootstrap file. Used to compute relative
paths for import generation.</p>
</li>
<li>
<p><strong><code>packageName</code></strong><br>
The name of the package whose assets are being discovered.</p>
</li>
<li>
<p><strong><code>fileUtils</code></strong><br>
The utility responsible for discovering resource files and reading bytes.
Must expose:</p>
<ul>
<li><code>discoverAllResources</code></li>
<li><code>resource.getContentBytes()</code></li>
<li>file/format helpers</li>
</ul>
</li>
</ul>
<h2 id="behavior-summary">Behavior Summary</h2>
<ol>
<li>Starts a spinner</li>
<li>Ensures the output directory exists</li>
<li>Discovers all embeddable resources in the package</li>
<li>For each resource:
<ul>
<li>Sanitizes names for safe class identifiers</li>
<li>Converts the file‚Äôs binary bytes to a Dart byte literal</li>
<li>Generates a fully documented Dart file</li>
<li>Adds an import entry to the returned set</li>
</ul>
</li>
<li>Stops the spinner with a success message</li>
</ol>
<h2 id="error-handling">Error Handling</h2>
<ul>
<li>The method does <strong>not throw</strong> for missing assets; it simply emits none.</li>
<li>File I/O errors from <code>writeAsString</code> propagate upward to the caller.</li>
<li>Byte reading is delegated fully to <code>fileUtils</code>.</li>
</ul>
<h2 id="performance-notes">Performance Notes</h2>
<ul>
<li>Byte lists are embedded directly into the generated Dart files, making
access extremely fast at runtime.</li>
<li>Resources are not tree-shaken out of the final AOT build because the
generated files are imported explicitly.</li>
</ul>
<p>This method is used during the JetLeaf bootstrap generation phase and is
not intended for direct invocation outside the build system.</p>
</section>


    
<section class="summary source-code" id="source">
  <h2><span>Implementation</span></h2>
  <pre class="language-dart"><code class="language-dart">@protected
Future&lt;String&gt; generateAndWriteAssets(String targetPath, String packageName, FileUtility fileUtils, CliLogger logger) async {
  final spinner = Spinner(&#39;üîç Embedding assets into dart classes...&#39;);
  spinner.start();

  final outputPath = p.join(p.dirname(targetPath), &quot;generated_assets.dart&quot;);
  final outputFile = File(outputPath);

  if (!outputFile.existsSync()) {
    await outputFile.create(recursive: true);
  }

  final resources = await fileUtils.discoverAllResources(packageName);
  if (resources.isNotEmpty) {
    final buffer = StringBuffer();

    &#47;&#47; Write header
    writeHeader(buffer, outputPath, logger);
    buffer.writeln(&quot;import &#39;dart:typed_data&#39;;&quot;);
    buffer.writeln();
    buffer.writeln(&quot;import &#39;package:jetleaf_lang&#47;lang.dart&#39; show GenerativeAsset;&quot;);

    final addedItem = &lt;String&gt;{};

    for (final resource in resources) {
      if (!addedItem.add(resource.getFilePath())) {
        continue;
      }

      final generatedPackageName = &quot;$GenerativeAsset${resources.indexOf(resource)}&quot;;
      final sanitizedPackageName = sanitizePackageName(resource.getPackageName() ?? generatedPackageName);
      final sanitizedFileName = sanitizeFileName(resource.getFileName());
      final fileExtension = resource.getFilePath().split(&#39;.&#39;).last;
      final className = &#39;Generative$sanitizedPackageName$sanitizedFileName${fileExtension.capitalizeFirst}Asset&#39;;

      final fileContentBytes = resource.getContentBytes();
      final byteListString = fileContentBytes.map((b) =&gt; &#39;0x${b.toRadixString(16).padLeft(2, &#39;0&#39;)}&#39;).join(&#39;, &#39;);

      buffer.write(&#39;&#39;&#39;

&#47;&#47;&#47; {@template ${className.toLowerCase().snakeCase()}}
&#47;&#47;&#47; A generated asset representing the file:
&#47;&#47;&#47;
&#47;&#47;&#47; **Package:** `${resource.getPackageName()}`
&#47;&#47;&#47; **Path:** `${resource.getFilePath()}`
&#47;&#47;&#47; **File:** `${resource.getFileName()}`
&#47;&#47;&#47;
&#47;&#47;&#47; This class is auto-generated by JetLeaf during the resource build phase.
&#47;&#47;&#47;
&#47;&#47;&#47; It exposes:
&#47;&#47;&#47; - the asset&#39;s file path
&#47;&#47;&#47; - the file name
&#47;&#47;&#47; - the package it belongs to
&#47;&#47;&#47; - the embedded binary bytes of the asset
&#47;&#47;&#47;
&#47;&#47;&#47; The constructor intentionally has **no arguments** so that JetLeaf can
&#47;&#47;&#47; instantiate it reflectively at runtime (via mirrors).
&#47;&#47;&#47;
&#47;&#47;&#47; Do not modify manually. This file will be regenerated.
&#47;&#47;&#47; {@endtemplate}
final class $className extends GenerativeAsset {
&#47;&#47;&#47; {@macro ${className.toLowerCase().snakeCase()}}
$className();

@override
String getFilePath() =&gt; &#39;${resource.getFilePath()}&#39;;

@override
String getFileName() =&gt; &#39;${resource.getFileName()}&#39;;

@override
String? getPackageName() =&gt; &#39;${resource.getPackageName()}&#39;;

@override
Uint8List getContentBytes() =&gt; Uint8List.fromList([$byteListString]);
}
&#39;&#39;&#39;);
      await outputFile.writeAsString(buffer.toString());
    }

    spinner.stop();
    logger.info(&#39;‚úÖ Embedded ${resources.length} resources into dart classes in ${outputFile.path}&#39;);
  } else {
    spinner.stop();
    logger.warn(&#39;‚ÑπÔ∏è No non-dart resource files found to embed.&#39;);
  }

  return p.relative(outputPath, from: p.dirname(targetPath));
}</code></pre>
</section>


  </div> <!-- /.main-content -->
  <div id="dartdoc-sidebar-left" class="sidebar sidebar-offcanvas-left">
    <!-- The search input and breadcrumbs below are only responsively visible at low resolutions. -->
<header id="header-search-sidebar" class="hidden-l">
  <form class="search-sidebar" role="search">
    <input type="text" id="search-sidebar" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
  </form>
</header>
<ol class="breadcrumbs gt-separated dark hidden-l" id="sidebar-nav">
    <li><a href="../../index.html">jetleaf_devtool</a></li>
    <li><a href="../../jetleaf_devtool/">jetleaf_devtool</a></li>
    <li><a href="../../jetleaf_devtool/GenerativeSupport-class.html">GenerativeSupport</a></li>
    <li class="self-crumb">generateAndWriteAssets method</li>
</ol>

    <h5>GenerativeSupport class</h5>
    <div id="dartdoc-sidebar-left-content"></div>
  </div><!--/.sidebar-offcanvas-->
  <div id="dartdoc-sidebar-right" class="sidebar sidebar-offcanvas-right">
</div><!--/.sidebar-offcanvas-->
</main>
<footer>
  <span class="no-break">
    jetleaf_devtool
      1.0.0
  </span>
  
</footer>


<script src="../../static-assets/highlight.pack.js?v1"></script>
<script src="../../static-assets/docs.dart.js"></script>

</body>
</html>

